{"Version":"2019-10-30","StartAction":"861b6b30-8f59-435a-b8c8-9ffb5c032afc","Metadata":{"entryPointPosition":{"x":14.4,"y":14.4},"ActionMetadata":{"861b6b30-8f59-435a-b8c8-9ffb5c032afc":{"position":{"x":221.6,"y":32}},"6339b495-ff9d-4022-91aa-af443e242140":{"position":{"x":245.6,"y":248},"overrideConsoleVoice":true},"445091d5-fa5e-4eb9-aa7d-222aa3e351bf":{"position":{"x":499.2,"y":33.6},"parameters":{"Attributes":{"CallbackNumber":{"useDynamic":true}}},"dynamicParams":["CallbackNumber"]},"query callback record":{"position":{"x":528,"y":291.2},"isFriendlyName":true,"parameters":{"LambdaFunctionARN":{"displayName":"alpha-001-callbackmgmt-read-callback"}},"dynamicMetadata":{}},"cc1e8a67-b3d7-491a-852a-4ecbb838d87f":{"position":{"x":824.8,"y":764}},"30aa5dc2-b9f5-404e-b5c4-9a8f6b230303":{"position":{"x":826.4,"y":30.4},"parameters":{"Attributes":{"CallBackStatus":{"useDynamic":true}}},"dynamicParams":["CallBackStatus"]},"10 digit formatted":{"position":{"x":1136,"y":174.4},"isFriendlyName":true,"parameters":{"LambdaFunctionARN":{"displayName":"alpha-001-callbackmgmt-get-10-digit-phone"},"LambdaInvocationAttributes":{"enteredPhoneNumber":{"useDynamic":true}}},"dynamicMetadata":{"enteredPhoneNumber":true}},"CallBack Status Check":{"position":{"x":850.4,"y":296},"isFriendlyName":true,"conditions":[],"conditionMetadata":[{"id":"ac9377d0-a26b-4e54-9722-eebb942249d7","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"PENDING"},{"id":"d2846e6f-a856-4940-901a-f0c9f50a5740","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"CANCELLED"}]},"ef1f6377-dda8-4412-9cef-5918c9cac17b":{"position":{"x":1928.8,"y":692.8}},"23119d0a-8093-43b8-a6c3-a3213b9672c8":{"position":{"x":1920,"y":432}},"1c6c688d-7365-4263-a702-5e40e0f86009":{"position":{"x":2196,"y":683.2}},"1bf880c6-e864-4f66-8f91-3cc1fb73e578":{"position":{"x":1415.2,"y":178.4},"parameters":{"Attributes":{"TenDigitPhoneNumber":{"useDynamic":true}}},"dynamicParams":["TenDigitPhoneNumber"]},"a0fbb23b-bbe6-40a9-86e5-925d238ba325":{"position":{"x":1670.4,"y":182.4}},"a546ea71-8d53-4438-ad18-8e260664bc45":{"position":{"x":2871.2,"y":624.8}}},"Annotations":[],"name":"cfAgentCallBackWhisperflow_03112024","description":"","type":"agentWhisper","status":"published","hash":{}},"Actions":[{"Parameters":{"FlowLoggingBehavior":"Enabled"},"Identifier":"861b6b30-8f59-435a-b8c8-9ffb5c032afc","Type":"UpdateFlowLoggingBehavior","Transitions":{"NextAction":"6339b495-ff9d-4022-91aa-af443e242140"}},{"Parameters":{"TextToSpeechVoice":"Joanna","TextToSpeechEngine":"Neural","TextToSpeechStyle":"Conversational"},"Identifier":"6339b495-ff9d-4022-91aa-af443e242140","Type":"UpdateContactTextToSpeechVoice","Transitions":{"NextAction":"445091d5-fa5e-4eb9-aa7d-222aa3e351bf"}},{"Parameters":{"Attributes":{"CallbackNumber":"$.CallbackNumber","ContactFlowName":"cbAgentCallBackWhisper"},"TargetContact":"Current"},"Identifier":"445091d5-fa5e-4eb9-aa7d-222aa3e351bf","Type":"UpdateContactAttributes","Transitions":{"NextAction":"query callback record","Errors":[{"NextAction":"query callback record","ErrorType":"NoMatchingError"}]}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-east-1:055037574009:function:alpha-001-callbackmgmt-read-callback","InvocationTimeLimitSeconds":"3","ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"query callback record","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"30aa5dc2-b9f5-404e-b5c4-9a8f6b230303","Errors":[{"NextAction":"cc1e8a67-b3d7-491a-852a-4ecbb838d87f","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Text":"Error or Time out in Lambda"},"Identifier":"cc1e8a67-b3d7-491a-852a-4ecbb838d87f","Type":"MessageParticipant","Transitions":{"NextAction":"ef1f6377-dda8-4412-9cef-5918c9cac17b"}},{"Parameters":{"Attributes":{"CallBackStatus":"$.External.CallBackStatus"},"TargetContact":"Current"},"Identifier":"30aa5dc2-b9f5-404e-b5c4-9a8f6b230303","Type":"UpdateContactAttributes","Transitions":{"NextAction":"CallBack Status Check","Errors":[{"NextAction":"CallBack Status Check","ErrorType":"NoMatchingError"}]}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-east-1:055037574009:function:alpha-001-callbackmgmt-get-10-digit-phone","InvocationTimeLimitSeconds":"8","LambdaInvocationAttributes":{"enteredPhoneNumber":"$.CallbackNumber"},"ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"10 digit formatted","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"1bf880c6-e864-4f66-8f91-3cc1fb73e578","Errors":[{"NextAction":"1bf880c6-e864-4f66-8f91-3cc1fb73e578","ErrorType":"NoMatchingError"}]}},{"Parameters":{"ComparisonValue":"$.Attributes.CallBackStatus"},"Identifier":"CallBack Status Check","Type":"Compare","Transitions":{"NextAction":"23119d0a-8093-43b8-a6c3-a3213b9672c8","Conditions":[{"NextAction":"10 digit formatted","Condition":{"Operator":"Equals","Operands":["PENDING"]}},{"NextAction":"23119d0a-8093-43b8-a6c3-a3213b9672c8","Condition":{"Operator":"Equals","Operands":["CANCELLED"]}}],"Errors":[{"NextAction":"23119d0a-8093-43b8-a6c3-a3213b9672c8","ErrorType":"NoMatchingCondition"}]}},{"Parameters":{"SSML":"<speak><break time=\"3s\"/>This is a cancelled callback. Please hangup the call.</speak>"},"Identifier":"ef1f6377-dda8-4412-9cef-5918c9cac17b","Type":"MessageParticipant","Transitions":{"NextAction":"1c6c688d-7365-4263-a702-5e40e0f86009"}},{"Parameters":{"Text":"Callback was cancelled, Please hang up the phone."},"Identifier":"23119d0a-8093-43b8-a6c3-a3213b9672c8","Type":"MessageParticipant","Transitions":{"NextAction":"ef1f6377-dda8-4412-9cef-5918c9cac17b"}},{"Parameters":{"LoopCount":"3"},"Identifier":"1c6c688d-7365-4263-a702-5e40e0f86009","Type":"Loop","Transitions":{"NextAction":"a546ea71-8d53-4438-ad18-8e260664bc45","Conditions":[{"NextAction":"23119d0a-8093-43b8-a6c3-a3213b9672c8","Condition":{"Operator":"Equals","Operands":["ContinueLooping"]}},{"NextAction":"a546ea71-8d53-4438-ad18-8e260664bc45","Condition":{"Operator":"Equals","Operands":["DoneLooping"]}}]}},{"Parameters":{"Attributes":{"TenDigitPhoneNumber":"$.External.TenDigitPhoneNumber"},"TargetContact":"Current"},"Identifier":"1bf880c6-e864-4f66-8f91-3cc1fb73e578","Type":"UpdateContactAttributes","Transitions":{"NextAction":"a0fbb23b-bbe6-40a9-86e5-925d238ba325","Errors":[{"NextAction":"a0fbb23b-bbe6-40a9-86e5-925d238ba325","ErrorType":"NoMatchingError"}]}},{"Parameters":{"SSML":"<speak>Hello, you have a new callback request. The customerâ€™s phone number is. <say-as interpret-as=\"telephone\">$.Attributes.TenDigitPhoneNumber</say-as>.\nPlease hold while I call the customer</speak>"},"Identifier":"a0fbb23b-bbe6-40a9-86e5-925d238ba325","Type":"MessageParticipant","Transitions":{"NextAction":"a546ea71-8d53-4438-ad18-8e260664bc45"}},{"Parameters":{},"Identifier":"a546ea71-8d53-4438-ad18-8e260664bc45","Type":"EndFlowExecution","Transitions":{}}]}